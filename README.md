# 自动输入器 - 跨应用中文输入工具

## 🚀 功能特性

✅ **完美支持中文字符和换行符**
✅ **跨应用程序工作** - 支持VS Code、gedit、LibreOffice、浏览器等
✅ **智能窗口焦点管理** - 自动检测和激活目标窗口
✅ **多种输入方法** - 剪贴板、xdotool、ydotool等
✅ **实时进度显示** - 随时了解输入状态
✅ **全局快捷键** - 方便控制程序

## 📋 快速开始

### 1. 安装依赖工具（推荐）
```bash
sudo apt install xdotool xclip
```

### 2. 运行程序
```bash
python3 mouse.py
```

### 3. 使用步骤
1. 启动程序，点击"选择TXT文件"
2. 选择要输入的文本文件
3. 在5秒倒计时内切换到目标应用（VS Code、gedit等）
4. 将光标放在要输入文本的位置
5. 程序会自动开始输入内容

## 🎯 支持的应用程序

### 文本编辑器
- ✅ VS Code
- ✅ gedit (GNOME文本编辑器)
- ✅ Sublime Text
- ✅ nano, vim (终端编辑器)

### 办公软件
- ✅ LibreOffice Writer
- ✅ WPS Office
- ✅ Google Docs (浏览器)

### 聊天软件
- ✅ Telegram Desktop
- ✅ 微信 (Web版)
- ✅ QQ (Web版)

### 浏览器
- ✅ Firefox, Chrome (文本框)
- ✅ 任何网页输入框

### 终端
- ✅ GNOME Terminal
- ✅ Konsole
- ✅ xterm

## ⌨️ 快捷键

- **数字键 1**: 停止输入
- **数字键 2**: 重新选择文件
- **数字键 3**: 关闭程序

## 🛠️ 输入方法说明

### 自动选择（推荐）
程序会自动尝试以下方法，选择最适合的：

1. **剪贴板方法** - 最佳中文支持，适用于大部分应用
2. **xdotool方法** - 直接输入，兼容性好
3. **增强逐字符** - 逐字符处理，确保准确性
4. **基础ydotool** - 备用方案

### 手动选择
如果自动选择效果不佳，可以手动选择特定方法：
- **剪贴板方法**: 适用于支持Ctrl+V的应用
- **xdotool方法**: 适用于X11环境的大部分应用
- **逐字符输入**: 最稳定但较慢的方法

## 🔧 故障排除

### 问题1: 程序无法在目标应用中输入
**解决方案:**
1. 确保安装了 `xdotool` 和 `xclip`: `sudo apt install xdotool xclip`
2. 确保目标应用窗口处于活动状态
3. 在倒计时期间切换到目标应用并点击输入区域
4. 尝试不同的输入方法

### 问题2: 中文字符显示异常
**解决方案:**
1. 确保目标应用支持UTF-8编码
2. 优先使用"剪贴板方法"
3. 检查系统中文输入法设置

### 问题3: 换行符不生效
**解决方案:**
1. 使用"自动选择"模式
2. 确保文本文件使用标准换行符
3. 尝试"xdotool方法"

### 问题4: 权限问题
**解决方案:**
```bash
# 对于ydotool，可能需要特殊权限
sudo ydotool type "test"

# 或者将用户添加到input组
sudo usermod -a -G input $USER
```

## 🧪 测试工具

### 基础测试
```bash
python3 test_input_tools.py
```

### 跨应用测试
```bash
python3 test_cross_app.py
```

这些测试工具可以帮助诊断问题并验证功能。

## 📝 使用技巧

1. **选择合适的输入方法**: 对于中文内容，推荐使用"剪贴板方法"
2. **确保焦点正确**: 在倒计时期间务必切换到目标应用
3. **处理大文件**: 对于大文件，程序会显示进度并允许中途停止
4. **备份剪贴板**: 剪贴板方法会自动备份和恢复原始剪贴板内容
5. **多次尝试**: 如果一次失败，可以尝试不同的输入方法

## 🆘 获取帮助

如果遇到问题:
1. 首先运行测试工具诊断问题
2. 检查是否安装了必要的依赖
3. 尝试不同的输入方法
4. 确保目标应用支持外部输入

---

**享受跨应用的中文输入体验！** 🎉
